# RD11 Optunaの開発

## コーディング課題
以下の URL から受験してください。 (URL 省略)

問題は全部で 3 問あります。
- 問題 1: (非公開の問題)
- 問題 2: 浮動小数点数のブロックフロート化
- 問題 3: 長方形画像のノイズ除去

コーディング課題の回答にあたっては、 Python3 を用いて回答してください。

## テーマ別課題
### 問題

Optunaの `GPSampler` に関して，以下の問いに回答してください．
ただし，必要があれば以下の定義を各問で利用してください．

- $x \in \mathbb{R}^D$: パラメータ．最適化したいD次元の変数のことでOptunaの用語で言えば，paramsにあたります．
- $y \in \mathbb{R}$: 目的関数値．Optunaの用語で言うとvalueにあたります．
- $\{(x_n, y_n)\}_{n=1}^N$: 観測集合．最適化中に観測したパラメータと対応する目的関数値の組の集合のことで，Optunaの用語で表すと `[(t.params, t.value) for t in study.trials]` になります．
- $k(x, x^\prime; \theta)$: $\theta$ をハイパパラメータとするカーネル関数．

#### 問1

[`GPSampler`](https://optuna.readthedocs.io/en/stable/reference/samplers/generated/optuna.samplers.GPSampler.html)を用いて最適化する10行以下のコードとその実行結果ログを提出物に別ファイルとして含めてください．尚，最適化する関数は任意のもので構いません．

#### 問2

`GPSampler`のGPはGaussian Process (ガウス過程) の略称です．`GPSampler`ではパラメータの提案毎にガウス過程を訓練します．ガウス過程の訓練では何を訓練するか説明してください．より具体的には，「Aをデータとして用いて，Bを入力としたときにCを出力とするようなモデルを訓練する」のA, B, Cに当てはまる単語を回答してください．

#### 問3

ガウス過程ではカーネル関数を用いて，新たな入力 $x^\star$ に対して問2の C を出力します．問2のAを訓練データとしたときの新しい入力 $x^\star$ に対するCを計算する手続きを説明してください．

#### 問4

`GPSampler`ではAを用いて訓練したガウス過程を用いて獲得関数を計算し，獲得関数の最適化結果を新しいパラメータとして各Trialで利用します．単一目的最適化における代表的な獲得関数 (の数式と名称) を1つ挙げ，その獲得関数を用いて各Trialのパラメータを選択する方法とガウス過程の事後平均を最大にするパラメータを選択する方法を比較し，挙動としてどのような違いが起こりうるか説明してください．

#### 問5

パラメータが連続値のみの場合，`GPSampler`では獲得関数の最適化に何を利用していますか？[Optuna v4.2.1](https://github.com/optuna/optuna/tree/v4.2.1)から該当する関数名を特定し，最適化に利用されている手法と併記する形で回答してください．

#### 問6

問2では省略しましたが，ガウス過程ではBに対するCが尤もらしくなるようにカーネル関数のハイパパラメータ $\theta$ を調整します．この学習の際には一般的な機械学習で行われる交差検証のような過剰適合を防ぐデータ分割は行いません．Optunaの`GPSampler`ではこの過剰適合を防ぐためにどのようなことを行っているか特定し，200文字以下で回答してください．(ただし，任意の長さのURLを1文字としてカウントします．)

### 提出方法

`survey.pdf` というファイル名で2ページ以内のPDFにまとめて提出してください．また，問1のファイルは別ファイルとして提出に含めてください．
